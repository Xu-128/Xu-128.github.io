<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>博弈论入门</title>
    <link href="/2022/03/01/%E7%AE%80%E5%8D%95%E5%8D%9A%E5%BC%88%E8%AE%BA/"/>
    <url>/2022/03/01/%E7%AE%80%E5%8D%95%E5%8D%9A%E5%BC%88%E8%AE%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="博弈论入门"><a href="#博弈论入门" class="headerlink" title="博弈论入门"></a>博弈论入门</h1><h2 id="公平组合游戏"><a href="#公平组合游戏" class="headerlink" title="公平组合游戏"></a>公平组合游戏</h2><p>公平组合游戏是指满足以下性质的游戏：</p><ul><li>游戏有且仅有两人，轮流操作。</li><li>双方在任意时刻的决策集合仅和时刻的状态有关，和决策者无关。</li></ul><h2 id="Nim-游戏"><a href="#Nim-游戏" class="headerlink" title="Nim 游戏"></a>Nim 游戏</h2><p>有 $n$ 堆石子，第 $i$ 堆石子有 $a_i$ 个。两名玩家轮流取走某一堆的若干个石子，可以取完但是不能不取，最后不能取石子的玩家判负，问先手是否有必胜策略。</p><h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>若 $a_1\oplus a_2\oplus \cdots\oplus a_n\not ={0}$ 先手必胜，否则先手必败。</p><h3 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h3><p>若存在一个局面的异或和不为 $0$，设当前异或和二进制表示下最高位的位数为 $k$，根据异或定义，一定有奇数个数在二进制的 $k$ 位上值为 $1$，所以一定存在一个 $a_i&gt;2^k$，可以从第 $i$ 堆里拿出 $a_i-2^k$ 个石子使得异或和为 $0$。</p><p>若当前局面异或和为 $0$，则一定不存在一种方案使得取完石子后异或和仍未零。可以使用反证法。设</p><script type="math/tex; mode=display">a_1\oplus\cdots\oplus a_i\oplus\cdots\oplus a_n = 0</script><p>若命题不成立，则可以在 $a_i$ 中取 $k$ 个石子使得异或和仍未零，则会有</p><script type="math/tex; mode=display">a_1\oplus\cdots\oplus (a_i - k)\oplus\cdots\oplus a_n = a_1\oplus\cdots\oplus a_i\oplus\cdots\oplus a_n = 0</script><p>根据异或的性质可以把无关项消掉，得到</p><script type="math/tex; mode=display">a_i=a_i-k\Rightarrow k=0</script><p>这与不取石子的规则相违背，故原命题成立。</p><h2 id="SG-函数"><a href="#SG-函数" class="headerlink" title="SG 函数"></a>SG 函数</h2><p>考虑到公平组合游戏千差万别，对于每一种游戏都想出一个类似于 Nim 游戏的精巧证明并不容易，所以我们引入了 SG 函数。</p><h3 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h3><p>首先举一个 Nim 游戏的例子。有四堆石子 $1,2,3,7$。考虑将母问题拆分成四个子问题。</p><p>对于第一堆石子，只能取 $1$ 个把它变成 $0$ 从而使得后手必败，我们称这种状态为 <b>一级胜态</b>，第二堆石子只能变成 $0,1$，称其为 <b>二级胜态</b>，以此类推可以得到 $n$ 个石子为 <b>$n$ 级胜态</b>。特别的，将 <b>$0$</b> 称作 <b>终态</b>，终态不可继续操作。</p><p>然后定义一个胜态为 $n$ 级胜态，当其可以变为 $[1,n-1]$ 中的所有等级胜态时。同时定义 $\operatorname{mex}$ 函数为找出一个非负整数集合里<b>未出现过</b>的<b>最小</b>非负整数值。</p><p>然后我们考虑给这个类似于函数的<b>胜态级别</b>取一个高端大气的名字…就叫 $SG$ 函数吧！</p><h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><!-- 对于任何一个母问题，都可以将其转化为两部分子问题。设母问题为 $X$，其可以分为 $A$ 和 $B$ 两个子问题。- 如果 $A$ 和 $B$ 均为先手必败的局面，此时无论先手如何操作都只能将局面变为一个先手必胜一个先手必败的局面（类比 Nim 游戏）。此时后手只需将必胜局面变为必败局面就可以将问题变回原样，直至 $A$ 和 $B$ 都为终态为止。所以此时先手必败。- 如果 $A$ 为先手必败，$B$ 为先手必胜，此时先手只需将 $B$ 变成先手必败状态，即可让后手进入第一种情况，所以此时先手必胜。- 如果 $A$ 和 $B$ 均为先手必胜，先手一定不能将局面转化为第二种情况，否则必败。所以在这种情况时，我们需要知道关于 $A$ 和 $B$ 更加详细的信息才能得知结果。 --><p>首先根据定义我们有</p><script type="math/tex; mode=display">SG(A)=\operatorname{mex}(SG(B)|A\rightarrow B)</script><p>然后定义一种运算 $@$ 表示将两个子问题合在一起，由基本事实可以得到：</p><ul><li>$SG(A@B@C)=SG(A@(B@C))$</li><li>$SG(A @ 0)=SG(A)$，因为一个空的子问题对答案没有影响。</li><li>$SG(A@A)=0$，因为两个相同的子问题无论先手如何操作后手都可以复制，所以先手必败。</li></ul><p>根据观察可以发现 $@$ 这种运算和 $\oplus$ 很相似，接下来我们将通过严谨的证明来说明 $@$ 和 $\oplus$ 是等价的。</p><p>由定义可知</p><script type="math/tex; mode=display">SG(A@B)=\operatorname{mex}(\{SG(C)|A\rightarrow C\}\{SG(D)|B\rightarrow D\})</script><p>如果要证明 $@\Leftrightarrow\oplus$，只需证明</p><ol><li>$SG(A)\oplus SG(B)\not\in\{\{SG(A)\oplus SG(C)|B\rightarrow C\}\cup\{SG(D)\oplus SG(B)|A\rightarrow D\}\}$</li><li>$\forall E &lt; SA(A)\oplus SG(B)$，都有 $E\in \{\{SG(A)\oplus SG(C)|B\rightarrow C\}\cup\{SG(D)\oplus SG(B)|A\rightarrow D\}\}$。</li></ol><p>对于第一个式子：</p><script type="math/tex; mode=display">\begin{aligned}&\because A\rightarrow C,~B\rightarrow D\\&\therefore SG(A)\not ={SG(B)},~SG(B)\not ={SG(D)}\\&\therefore SG(A)\oplus SG(B)\not\in\{\{SG(A)\oplus SG(C)|B\rightarrow C\}\cup\{SG(D)\oplus SG(B)|A\rightarrow D\}\}\end{aligned}</script><p>对于第二个式子：</p><p>设 $F=SG(A)\oplus SG(B)\oplus E$，将 $F$ 和组成它的三部分中的一个异或，一定会使得结果变小（因为 $F$ 最高位上的 $1$ 一定来自其一），而这个数一定不是 $E$，因为 $F\oplus E=SA(A)\oplus SA(B)&gt;E$（由 $E$ 的定义可知）。</p><p>不妨设 $F\oplus SG(A)&lt;SG(A)$，此时由 $SG(B)\oplus E&lt;SG(A)$，再由 $SG$ 函数额定义可以得到，一定有一个 $A$ 的后继状态 $C$ 使得 $SG(C)=SG(B)\oplus E$，从而有 $E=SB(C)\oplus SG(B)$。</p><p>然后我们就证明了 $\forall E &lt; SA(A)\oplus SG(B)$，都有 $E\in \{\{SG(A)\oplus SG(C)|B\rightarrow C\}\cup\{SG(D)\oplus SG(B)|A\rightarrow D\}\}$。</p><p>总结一下，我们就得到了 $SG$ 函数的两条高明性质：</p><ul><li>$SG(A)=\operatorname{mex}(SG(B)|A\rightarrow B)$</li><li>$SG(A@B)=SG(A)\oplus SG(B)$</li></ul><h2 id="习题"><a href="#习题" class="headerlink" title="习题"></a>习题</h2><h3 id="GZOI2017-取石子游戏"><a href="#GZOI2017-取石子游戏" class="headerlink" title="[GZOI2017] 取石子游戏"></a>[GZOI2017] 取石子游戏</h3><p>[题面](<a href="https://www.luogu.com.cn/problem/P5675">https://www.luogu.com.cn/problem/P5675</a>)</p><p>考虑 Nim 游戏的获胜条件，先手必胜当前仅当开始局面异或和为 $0$，为了让阴险的 Alice 不能获胜，有以下两种办法：</p><ul><li>开局异或和为 $0$。</li><li>开局异或和不为 $0$，但是指定的一堆石子数量小于其他石子的异或和。</li></ul><p>第一种情况可以认为是指定的一堆石子必须等于其他石子的异或和，所以我们的任务就是：从 $n$ 堆石子中选择任意堆，从选择的石子堆里面选出一堆，使其数量小于等于选择的其他石子的异或和。</p><p>考虑钦定 Alice 选哪一堆，然后用动态规划求出其余石子异或和大于等于选定石子个数的方案数即可。</p><p>设钦定 Alice 选择第 $i$ 堆石子， $f_{j, k}$ 表示前 $j$ 堆里，异或和等于 $k$ 的方案数，容易得到转移方程：</p><script type="math/tex; mode=display">f_{j,k}=\begin{cases}f_{j-1,k}&i=j\\f_{j-1,k}+f_{j-1,k\oplus A_j}&i\not ={j}\end{cases}</script><p>分两种情况的原因是钦定的石子堆是不能用来转移的。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-comment">//#define int long long</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> FL(a, b, c) memset(a, b, c)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> RE() cout &lt;&lt; <span class="hljs-string">&quot;What Happened?&quot;</span> &lt;&lt; endl</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> TE() cerr &lt;&lt; <span class="hljs-string">&quot;Time : &quot;</span> &lt;&lt; clock() &lt;&lt; <span class="hljs-string">&quot;(ms)&quot;</span> &lt;&lt; endl</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DG(x) cout &lt;&lt; <span class="hljs-string">&quot;Debug : &quot;</span> &lt;&lt; #x &lt;&lt; <span class="hljs-string">&quot; = &quot;</span> &lt;&lt; x &lt;&lt; endl</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> IR(a, b, c, ...) for(int a(b), ##__VA_ARGS__; a &lt;= c; ++a)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> OR(a, b, c, ...) for(int a(b), ##__VA_ARGS__; a &gt;= c; --a)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ER(a, b, c, ...) for(int a(head[b]), c(ver[a]), ##__VA_ARGS__; a; a = next[a], c = ver[a])</span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">FastIN</span> &#123;<br><span class="hljs-keyword">template</span> &lt; <span class="hljs-keyword">class</span> <span class="hljs-title class_">T</span> &gt; <span class="hljs-keyword">inline</span> FastIN&amp; <span class="hljs-keyword">operator</span> &gt;&gt; (T&amp; x) &#123;<br>x = <span class="hljs-number">0</span>; <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">sd</span><span class="hljs-params">(<span class="hljs-literal">false</span>)</span></span>;<br><span class="hljs-function"><span class="hljs-type">char</span> <span class="hljs-title">ch</span><span class="hljs-params">(getchar())</span></span>;<br><span class="hljs-keyword">while</span> (!<span class="hljs-built_in">isdigit</span>(ch) <span class="hljs-built_in">and</span> (ch != <span class="hljs-string">&#x27;-&#x27;</span>)) ch = <span class="hljs-built_in">getchar</span>();<br><span class="hljs-keyword">if</span> (ch == <span class="hljs-string">&#x27;-&#x27;</span>) sd = <span class="hljs-literal">true</span>, ch = <span class="hljs-built_in">getchar</span>();<br><span class="hljs-keyword">while</span> (ch &gt;= <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">and</span> ch &lt;= <span class="hljs-string">&#x27;9&#x27;</span>) x = (x &lt;&lt; <span class="hljs-number">3</span>) + (x &lt;&lt; <span class="hljs-number">1</span>) + ch - <span class="hljs-string">&#x27;0&#x27;</span>, ch = <span class="hljs-built_in">getchar</span>();<br><span class="hljs-keyword">if</span> (sd == <span class="hljs-literal">true</span>) x = -x;<br><span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;<br>&#125;<br>&#125; IN;<br><span class="hljs-function"><span class="hljs-type">const</span> <span class="hljs-type">int</span> <span class="hljs-title">INF</span><span class="hljs-params">(~<span class="hljs-number">0u</span> &gt;&gt; <span class="hljs-number">1</span>)</span></span>;<br><span class="hljs-keyword">template</span> &lt; <span class="hljs-keyword">class</span> <span class="hljs-title class_">T</span> &gt; <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">CL</span><span class="hljs-params">(T&amp; x_)</span> </span>&#123; <span class="hljs-built_in">FL</span>(x_, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> x_); &#125;<br><span class="hljs-keyword">template</span> &lt; <span class="hljs-keyword">class</span> <span class="hljs-title class_">T</span>, <span class="hljs-keyword">class</span>... Args&gt; <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">CL</span><span class="hljs-params">(T &amp;x_, Args&amp; ...others)</span> </span>&#123; <span class="hljs-built_in">FL</span>(x_, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> x_), <span class="hljs-built_in">CL</span>(others...); &#125;<br><br><span class="hljs-function"><span class="hljs-type">const</span> <span class="hljs-type">int</span> <span class="hljs-title">kN</span><span class="hljs-params">(<span class="hljs-number">222</span>)</span>, <span class="hljs-title">kV</span><span class="hljs-params">(<span class="hljs-number">257</span>)</span>, <span class="hljs-title">Mod</span><span class="hljs-params">(<span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>)</span></span>;<br><span class="hljs-type">int</span> N, A[kN], Ans;<br><span class="hljs-type">int</span> F[kN][kV];<br><br><span class="hljs-function"><span class="hljs-type">signed</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> FIO</span><br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;I:/Code/Data/In.in&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, stdin);<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;I:/Code/Data/Out.out&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>, stdout);<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br>  IN &gt;&gt; N; <span class="hljs-built_in">IR</span>(i, <span class="hljs-number">1</span>, N) IN &gt;&gt; A[i];<br><span class="hljs-built_in">IR</span>(i, <span class="hljs-number">1</span>, N) &#123;<br><span class="hljs-built_in">FL</span>(F, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> F);<br>F[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;        <br><span class="hljs-built_in">IR</span>(j, <span class="hljs-number">1</span>, N) &#123;<br><span class="hljs-built_in">IR</span>(k, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>) &#123;<br><span class="hljs-keyword">if</span> (i == j) F[j][k] = F[j - <span class="hljs-number">1</span>][k];<br><span class="hljs-keyword">else</span> F[j][k] = (F[j - <span class="hljs-number">1</span>][k] + F[j - <span class="hljs-number">1</span>][k ^ A[j]]) % Mod;<br>&#125;<br>&#125;<br><span class="hljs-built_in">IR</span>(j, A[i], <span class="hljs-number">255</span>) Ans = (Ans + F[N][j]) % Mod;<br>&#125;<br>cout &lt;&lt; Ans &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><script>var a=document.getElementsByTagName("h1");for(var i=0;i<a.length;++i)if(a[i].parentNode.className.indexOf("markdown-body")>-1)document.getElementById("subtitle").title=a[i].innerHTML,a[i].parentNode.removeChild(a[i]);</script>]]></content>
    
    
    <categories>
      
      <category>数学</category>
      
      <category>博弈论</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数学</tag>
      
      <tag>博弈论</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022-03-01 模拟赛题解</title>
    <link href="/2022/03/01/2022-03-01-%E6%A8%A1%E6%8B%9F%E8%B5%9B%E9%A2%98%E8%A7%A3/"/>
    <url>/2022/03/01/2022-03-01-%E6%A8%A1%E6%8B%9F%E8%B5%9B%E9%A2%98%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h1 id="2022-03-01-模拟赛题解"><a href="#2022-03-01-模拟赛题解" class="headerlink" title="2022-03-01 模拟赛题解"></a>2022-03-01 模拟赛题解</h1><h2 id="T1"><a href="#T1" class="headerlink" title="T1"></a>T1</h2><p>输入/输出优化模板（虽然 cin + string + deque） 的常数都过了？</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> FL(a, b, c) memset(a, b, c)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> RE() cout &lt;&lt; <span class="hljs-string">&quot;What Happened?&quot;</span> &lt;&lt; endl</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> TE() cerr &lt;&lt; <span class="hljs-string">&quot;Time : &quot;</span> &lt;&lt; clock() &lt;&lt; <span class="hljs-string">&quot;(ms)&quot;</span> &lt;&lt; endl</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DG(x) cout &lt;&lt; <span class="hljs-string">&quot;Debug : &quot;</span> &lt;&lt; #x &lt;&lt; <span class="hljs-string">&quot; = &quot;</span> &lt;&lt; x &lt;&lt; endl</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> IR(a, b, c, ...) for(unsigned int a(b), ##__VA_ARGS__; a &lt;= c; ++a)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> OR(a, b, c, ...) for(unsigned int a(b), ##__VA_ARGS__; a &gt;= c; --a)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ER(a, b, c, ...) for(unsigned int a(head[b]), c(ver[a]), ##__VA_ARGS__; a; a = next[a], c = ver[a])</span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">FastIN</span> &#123;<br><span class="hljs-type">char</span> buf[(<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">21</span>) + <span class="hljs-number">100</span>], *p, *e;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">getChar</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">if</span> (p == e) p = buf, e = buf + <span class="hljs-built_in">fread</span>(buf, <span class="hljs-number">1</span>, (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">21</span>), stdin);<br><span class="hljs-keyword">return</span> p == e ? EOF : *p++;<br>&#125;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">class</span> <span class="hljs-title class_">T</span>&gt;<br>FastIN&amp; <span class="hljs-keyword">operator</span> &gt;&gt; (T&amp; x) &#123;<br><span class="hljs-type">char</span> c, l;<br><span class="hljs-keyword">for</span> (c = <span class="hljs-number">0</span>; !<span class="hljs-built_in">isdigit</span>(c); c = <span class="hljs-built_in">getChar</span>()) l = c;<br><span class="hljs-keyword">for</span> (x = <span class="hljs-number">0</span>; <span class="hljs-built_in">isdigit</span>(c); c = <span class="hljs-built_in">getChar</span>()) x = x * <span class="hljs-number">10</span> - <span class="hljs-string">&#x27;0&#x27;</span> + c;<br><span class="hljs-keyword">if</span> (l == <span class="hljs-string">&#x27;-&#x27;</span>) x = -x;<br><span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;<br>&#125;<br><span class="hljs-keyword">template</span> &lt; <span class="hljs-keyword">class</span> <span class="hljs-title class_">T</span> &gt; <span class="hljs-keyword">inline</span> FastIN&amp; <span class="hljs-keyword">operator</span> &lt;&lt; (T x) &#123;<br><span class="hljs-keyword">if</span> (x &gt;= <span class="hljs-number">10</span>) *<span class="hljs-keyword">this</span> &lt;&lt; x / <span class="hljs-number">10</span>;<br><span class="hljs-built_in">putchar</span>(x % <span class="hljs-number">10</span> + <span class="hljs-string">&#x27;0&#x27;</span>);<br><span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;<br>&#125;<br>&#125; IN;<br><span class="hljs-function"><span class="hljs-type">const</span> <span class="hljs-type">int</span> <span class="hljs-title">INF</span><span class="hljs-params">(~<span class="hljs-number">0u</span> &gt;&gt; <span class="hljs-number">1</span>)</span></span>;<br><span class="hljs-keyword">template</span> &lt; <span class="hljs-keyword">class</span> <span class="hljs-title class_">T</span> &gt; <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">CL</span><span class="hljs-params">(T&amp; x_)</span> </span>&#123; <span class="hljs-built_in">FL</span>(x_, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> x_); &#125;<br><span class="hljs-keyword">template</span> &lt; <span class="hljs-keyword">class</span> <span class="hljs-title class_">T</span>, <span class="hljs-keyword">class</span>... Args&gt; <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">CL</span><span class="hljs-params">(T &amp;x_, Args&amp; ...others)</span> </span>&#123; <span class="hljs-built_in">FL</span>(x_, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> x_), <span class="hljs-built_in">CL</span>(others...); &#125;<br><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> kN = <span class="hljs-number">1e5</span> + <span class="hljs-number">15</span>, kM = <span class="hljs-number">1e7</span> + <span class="hljs-number">17</span>;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> N, P;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">short</span> A[kN];<br><span class="hljs-type">unsigned</span> <span class="hljs-type">short</span> Ans[kM];<br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> Top;<br>deque &lt; <span class="hljs-type">unsigned</span> <span class="hljs-type">short</span> &gt; Q;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> Opt[kM];<br><br><span class="hljs-function"><span class="hljs-type">signed</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> FIO</span><br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;I:/Code/Data/In.in&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, stdin);<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;I:/Code/Data/Out.out&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>, stdout);<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br>IN &gt;&gt; N; <span class="hljs-built_in">IR</span>(i, <span class="hljs-number">1</span>, N) IN &gt;&gt; A[i];<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">cnt</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span></span>; IN &gt;&gt; P;<br><span class="hljs-built_in">IR</span>(i, <span class="hljs-number">1</span>, P) &#123;<br><span class="hljs-function"><span class="hljs-type">char</span> <span class="hljs-title">Opt</span><span class="hljs-params">(IN.getChar())</span></span>;<br><span class="hljs-keyword">while</span> (Opt &lt; <span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">or</span> Opt &gt; <span class="hljs-string">&#x27;4&#x27;</span>) IN.<span class="hljs-built_in">getChar</span>();<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">op</span><span class="hljs-params">(Opt - <span class="hljs-string">&#x27;0&#x27;</span>)</span></span>;<br><span class="hljs-keyword">if</span> (op == <span class="hljs-number">1</span>) &#123;<br>Q.<span class="hljs-built_in">push_back</span>(A[cnt]);<br><span class="hljs-keyword">if</span> (++cnt == N + <span class="hljs-number">1</span>) cnt = <span class="hljs-number">1</span>;<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-number">2</span>) &#123;<br>Ans[++Top] = Q.<span class="hljs-built_in">front</span>(); Q.<span class="hljs-built_in">pop_front</span>();<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-number">3</span>) &#123;<br>Ans[++Top] = Q.<span class="hljs-built_in">back</span>(); Q.<span class="hljs-built_in">pop_back</span>();<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-type">bool</span> flag = <span class="hljs-literal">true</span>;<br><span class="hljs-built_in">IR</span>(j, <span class="hljs-number">1</span>, Top) &#123;<br><span class="hljs-keyword">if</span> (flag <span class="hljs-keyword">and</span> Ans[j] != <span class="hljs-number">0</span>) flag = <span class="hljs-literal">false</span>;<br><span class="hljs-keyword">if</span> (flag == <span class="hljs-literal">false</span>) IN &lt;&lt; Ans[j];<br>&#125;<br><span class="hljs-keyword">if</span> (flag == <span class="hljs-literal">true</span>) <span class="hljs-built_in">putchar</span>(<span class="hljs-string">&#x27;0&#x27;</span>);<br><span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&quot;</span>);<br>Top = <span class="hljs-number">0</span>;<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="T2"><a href="#T2" class="headerlink" title="T2"></a>T2</h2><p>状态压缩 DP，但是我不会 awa。</p><p>设 $f(i,j)$ 表示最后一个任务点为 $i$，已经做完的任务集合为 $j$ 时的答案， $g(i, j)$ 表示达到 $f(i, j)$ 答案时的最短时间。</p><p>枚举下一个走到的任务点转移即可（要注意当 $f$ 变大时，$g$ 不能取较小值而应该直接复制）。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> FL(a, b, c) memset(a, b, c)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> RE() cout &lt;&lt; <span class="hljs-string">&quot;What Happened?&quot;</span> &lt;&lt; endl</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> TE() cerr &lt;&lt; <span class="hljs-string">&quot;Time : &quot;</span> &lt;&lt; clock() &lt;&lt; <span class="hljs-string">&quot;(ms)&quot;</span> &lt;&lt; endl</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DG(x) cout &lt;&lt; <span class="hljs-string">&quot;Debug : &quot;</span> &lt;&lt; #x &lt;&lt; <span class="hljs-string">&quot; = &quot;</span> &lt;&lt; x &lt;&lt; endl</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> IR(a, b, c, ...) for(int a(b), ##__VA_ARGS__; a &lt;= c; ++a)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> OR(a, b, c, ...) for(int a(b), ##__VA_ARGS__; a &gt;= c; --a)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ER(a, b, c, ...) for(int a(head[b]), c(ver[a]), ##__VA_ARGS__; a; a = next[a], c = ver[a])</span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">FastIN</span> &#123;<br><span class="hljs-keyword">template</span> &lt; <span class="hljs-keyword">class</span> <span class="hljs-title class_">T</span> &gt; <span class="hljs-keyword">inline</span> FastIN&amp; <span class="hljs-keyword">operator</span> &gt;&gt; (T&amp; x) &#123;<br>x = <span class="hljs-number">0</span>; <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">sd</span><span class="hljs-params">(<span class="hljs-literal">false</span>)</span></span>;<br><span class="hljs-function"><span class="hljs-type">char</span> <span class="hljs-title">ch</span><span class="hljs-params">(getchar())</span></span>;<br><span class="hljs-keyword">while</span> (!<span class="hljs-built_in">isdigit</span>(ch) <span class="hljs-built_in">and</span> (ch != <span class="hljs-string">&#x27;-&#x27;</span>)) ch = <span class="hljs-built_in">getchar</span>();<br><span class="hljs-keyword">if</span> (ch == <span class="hljs-string">&#x27;-&#x27;</span>) sd = <span class="hljs-literal">true</span>, ch = <span class="hljs-built_in">getchar</span>();<br><span class="hljs-keyword">while</span> (ch &gt;= <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">and</span> ch &lt;= <span class="hljs-string">&#x27;9&#x27;</span>) x = (x &lt;&lt; <span class="hljs-number">3</span>) + (x &lt;&lt; <span class="hljs-number">1</span>) + ch - <span class="hljs-string">&#x27;0&#x27;</span>, ch = <span class="hljs-built_in">getchar</span>();<br><span class="hljs-keyword">if</span> (sd == <span class="hljs-literal">true</span>) x = -x;<br><span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;<br>&#125;<br>&#125; IN;<br><span class="hljs-function"><span class="hljs-type">const</span> <span class="hljs-type">int</span> <span class="hljs-title">INF</span><span class="hljs-params">(~<span class="hljs-number">0u</span> &gt;&gt; <span class="hljs-number">1</span>)</span></span>;<br><span class="hljs-keyword">template</span> &lt; <span class="hljs-keyword">class</span> <span class="hljs-title class_">T</span> &gt; <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">CL</span><span class="hljs-params">(T&amp; x_)</span> </span>&#123; <span class="hljs-built_in">FL</span>(x_, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> x_); &#125;<br><span class="hljs-keyword">template</span> &lt; <span class="hljs-keyword">class</span> <span class="hljs-title class_">T</span>, <span class="hljs-keyword">class</span>... Args&gt; <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">CL</span><span class="hljs-params">(T &amp;x_, Args&amp; ...others)</span> </span>&#123; <span class="hljs-built_in">FL</span>(x_, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> x_), <span class="hljs-built_in">CL</span>(others...); &#125;<br><br><span class="hljs-function"><span class="hljs-type">const</span> <span class="hljs-type">int</span> <span class="hljs-title">kN</span><span class="hljs-params">(<span class="hljs-number">222</span>)</span>, <span class="hljs-title">kK</span><span class="hljs-params">(<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">18</span>)</span></span>;<br><span class="hljs-type">int</span> N, M, K;<br><span class="hljs-type">int</span> Mp[kN][kN];<br><span class="hljs-type">int</span> F[<span class="hljs-number">20</span>][kK], G[<span class="hljs-number">20</span>][kK];<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">NODE</span> &#123;<br><span class="hljs-type">int</span> u, l, r, t, c;<br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">In</span><span class="hljs-params">()</span> </span>&#123; IN &gt;&gt; u &gt;&gt; l &gt;&gt; r &gt;&gt; t &gt;&gt; c; &#125;<br>&#125; D[kN];<br><br><span class="hljs-function"><span class="hljs-type">signed</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> FIO</span><br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;I:/Code/Data/In.in&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, stdin);<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;I:/Code/Data/Out.out&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>, stdout);<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br>IN &gt;&gt; N &gt;&gt; M; <span class="hljs-built_in">FL</span>(Mp, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> Mp); <span class="hljs-built_in">IR</span>(i, <span class="hljs-number">1</span>, N) Mp[i][i] = <span class="hljs-number">0</span>;<br><span class="hljs-built_in">IR</span>(i, <span class="hljs-number">1</span>, M, x, y, z) IN &gt;&gt; x &gt;&gt; y &gt;&gt; z,<br>Mp[x][y] = <span class="hljs-built_in">min</span>(Mp[x][y], z), Mp[y][x] = <span class="hljs-built_in">min</span>(Mp[y][x], z);<br>IN &gt;&gt; K; <span class="hljs-built_in">IR</span>(i, <span class="hljs-number">1</span>, K) D[i].<span class="hljs-built_in">In</span>();<br><span class="hljs-built_in">IR</span>(k, <span class="hljs-number">1</span>, N) <span class="hljs-built_in">IR</span>(i, <span class="hljs-number">1</span>, N) <span class="hljs-built_in">IR</span>(j, <span class="hljs-number">1</span>, N)<br>Mp[i][j] = <span class="hljs-built_in">min</span>(Mp[i][j], Mp[i][k] + Mp[k][j]);<br><span class="hljs-comment">//IR(i, 1, N) IR(j, 1, N) cout &lt;&lt; i &lt;&lt; &quot; -&gt; &quot; &lt;&lt; j &lt;&lt; &quot; : &quot; &lt;&lt; Mp[i][j] &lt;&lt; &quot;\n&quot;;</span><br><span class="hljs-built_in">FL</span>(F, <span class="hljs-number">0xcf</span>, <span class="hljs-keyword">sizeof</span> F), <span class="hljs-built_in">FL</span>(G, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> G);<br>F[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = G[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br><span class="hljs-built_in">IR</span>(S, <span class="hljs-number">0</span>, (<span class="hljs-number">1</span> &lt;&lt; K) - <span class="hljs-number">1</span>) &#123;<br><span class="hljs-built_in">IR</span>(i, <span class="hljs-number">1</span>, K) &#123;<br><span class="hljs-built_in">IR</span>(k, <span class="hljs-number">1</span>, K) &#123;<br><span class="hljs-keyword">if</span> ((S &gt;&gt; (k - <span class="hljs-number">1</span>)) &amp; <span class="hljs-number">1</span>) <span class="hljs-keyword">continue</span>;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">To</span><span class="hljs-params">(D[k].u)</span>, <span class="hljs-title">Fr</span><span class="hljs-params">(D[i].u)</span></span>;<br><span class="hljs-keyword">if</span> (G[i][S] + Mp[Fr][To] &gt; D[k].r) <span class="hljs-keyword">continue</span>;<br><span class="hljs-comment">//RE();</span><br><span class="hljs-keyword">if</span> (F[i][S] + D[k].c &gt; F[k][S | (<span class="hljs-number">1</span> &lt;&lt; (k - <span class="hljs-number">1</span>))]) &#123;<br>F[k][S | (<span class="hljs-number">1</span> &lt;&lt; (k - <span class="hljs-number">1</span>))] = <span class="hljs-built_in">max</span>(<br>F[k][S | (<span class="hljs-number">1</span> &lt;&lt; (k - <span class="hljs-number">1</span>))],<br>F[i][S] + D[k].c<br>);<br>G[k][S | (<span class="hljs-number">1</span> &lt;&lt; (k - <span class="hljs-number">1</span>))] = <span class="hljs-built_in">max</span>(D[k].l, G[i][S] + Mp[Fr][To]) + D[k].t;<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (F[i][S] + D[k].c == F[k][S | (<span class="hljs-number">1</span> &lt;&lt; (k - <span class="hljs-number">1</span>))]) &#123;<br>G[k][S | (<span class="hljs-number">1</span> &lt;&lt; (k - <span class="hljs-number">1</span>))] = <span class="hljs-built_in">min</span>(<br>G[k][S | (<span class="hljs-number">1</span> &lt;&lt; (k - <span class="hljs-number">1</span>))],<br><span class="hljs-built_in">max</span>(D[k].l, G[i][S] + Mp[Fr][To]) + D[k].t<br>);<br>&#125;<br><br>&#125;<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">ans</span><span class="hljs-params">(-INF)</span></span>;<br><span class="hljs-built_in">IR</span>(S, <span class="hljs-number">0</span>, (<span class="hljs-number">1</span> &lt;&lt; K) - <span class="hljs-number">1</span>) <span class="hljs-built_in">IR</span>(i, <span class="hljs-number">1</span>, K) ans = <span class="hljs-built_in">max</span>(ans, F[i][S]);<br>cout &lt;&lt; ans &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-built_in">TE</span>();<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="T3"><a href="#T3" class="headerlink" title="T3"></a>T3</h2><p>还不会…</p><script>var a=document.getElementsByTagName("h1");for(var i=0;i<a.length;++i)if(a[i].parentNode.className.indexOf("markdown-body")>-1)document.getElementById("subtitle").title=a[i].innerHTML,a[i].parentNode.removeChild(a[i]);</script>]]></content>
    
    
    <categories>
      
      <category>模拟赛</category>
      
    </categories>
    
    
    <tags>
      
      <tag>模拟赛</tag>
      
      <tag>题解</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>多项式入门</title>
    <link href="/2022/02/28/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/02/28/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="多项式笔记"><a href="#多项式笔记" class="headerlink" title="多项式笔记"></a>多项式笔记</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>定义 $n$ 次多项式 $f(x)=\sum_{i=0}^na_ix^i$，称其最高项系数的次数为该多项式的度，记作 $\deg f$。</p><h2 id="运算"><a href="#运算" class="headerlink" title="运算"></a>运算</h2><p>定义如下多项式</p><script type="math/tex; mode=display">f(x)=\sum_{i=0}^na_ix^i\\g(x)=\sum_{i=0}^nb_ix^i\\</script><h3 id="加法"><a href="#加法" class="headerlink" title="加法"></a>加法</h3><script type="math/tex; mode=display">f(x)+f(y)=\sum_{i=0}^n(a_i+b_i)x^i</script><h3 id="减法"><a href="#减法" class="headerlink" title="减法"></a>减法</h3><script type="math/tex; mode=display">f(x)-f(y)=\sum_{i=0}^n(a_i-b_i)x^i</script><h3 id="乘法"><a href="#乘法" class="headerlink" title="乘法"></a>乘法</h3><script type="math/tex; mode=display">f(x)\cdot g(x)=\sum_{i=0}^n\sum_{j=0}^na_ib_jx^{i+j}</script><h3 id="除法"><a href="#除法" class="headerlink" title="除法"></a>除法</h3><p>若存在唯一的 $Q(x),~R(x)$ 满足</p><script type="math/tex; mode=display">f(x)=Q(x)g(x)+R(x)\\\deg R < \deg g</script><p>若 $\deg f &gt; \deg g$，此时 $\deg Q=\deg  f-\deg g$，否则有 $Q(x)=0$。称 $Q(x)$ 为 $f(x)$ 除以 $g(x)$ 的商， $R(x)$ 为 $f(x)$ 除以 $g(x)$ 的余数，也可以记作</p><script type="math/tex; mode=display">f(x)\equiv R(x)(mod~g(x))</script><h2 id="朗格拉日插值"><a href="#朗格拉日插值" class="headerlink" title="朗格拉日插值"></a>朗格拉日插值</h2><p>有初中数学可以知道，如果给定平面上的 $n$ 个点，则可以唯一确定一个 $n-1$ 次的多项式（如两点确定一个一次多项式，三点确定一个二次多项式），如果要求出该多项式每一项的系数，可以使用高斯消元法， 时间复杂度为 $O(n^3)$，时间复杂度过高。</p><p>朗格拉日插值法使用构造的方式在 $O(n^2)$ 求解多项式系数。</p><p>首先构造 $n$ 个函数，其中第 $i$ 个函数 $f_i(x)$ 满足<br>$<br>f_i(x)=\begin{cases}<br>0&amp; (x\not=x_i)\\<br>y_i&amp; (x= x_i)<br>\end{cases}<br>$  </p><p>最后要求的多项式 $f(x)=\sum_{i=1}^nf_i(x)$。<br>可以设</p><script type="math/tex; mode=display">f_i(x)=a\cdot\prod_{j\not=i}(x-x_j)</script><p>将 $f_i(x_i)=y_i$ 代入得到</p><script type="math/tex; mode=display">a=\frac{y_i}{\prod_{j\not ={i}}}(x_i-x_j)</script><p>所以</p><script type="math/tex; mode=display">f(x)=\sum_{i=1}^ny_i\prod_{j\not ={i}}\frac{x-x_j}{x_i-x_j}</script><script>var a=document.getElementsByTagName("h1");for(var i=0;i<a.length;++i)if(a[i].parentNode.className.indexOf("markdown-body")>-1)document.getElementById("subtitle").title=a[i].innerHTML,a[i].parentNode.removeChild(a[i]);</script>]]></content>
    
    
    <categories>
      
      <category>数学</category>
      
      <category>多项式</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数学</tag>
      
      <tag>多项式</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>反演浅谈</title>
    <link href="/2022/02/27/%E5%8F%8D%E6%BC%94/"/>
    <url>/2022/02/27/%E5%8F%8D%E6%BC%94/</url>
    
    <content type="html"><![CDATA[<!-- <font size=6><center><b>反演浅谈</b></center></font> --><!-- <h1 style="border-style:none;text-align:center;">反演浅谈</h1> --><h1 id="反演浅谈"><a href="#反演浅谈" class="headerlink" title="反演浅谈"></a>反演浅谈</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>如果有离散函数 $f$ 能推导出 离散函数 $g$，则称这个过程为“演绎”，如果我们知道了演绎的过程，想通过 $g$ 推出 $f$，这个过程通常称作“反演”。</p><p>如果两函数没有特殊性质，反演只能通过高斯消元求解，但是如果函数之间满足某种特定关系，则可以使用某些特定方式进行求解。</p><h2 id="二项式反演"><a href="#二项式反演" class="headerlink" title="二项式反演"></a>二项式反演</h2><h3 id="形式"><a href="#形式" class="headerlink" title="形式"></a>形式</h3><script type="math/tex; mode=display">g_n=\sum_{i=0}^n\binom{n}{i}f_i\iff f_n=\sum_{i=0  }^n(-1)^{n-i}\binom{n}{i}g_i</script><p>左边为演绎过程，右边为反演过程。</p><h3 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h3><p>先将左边带入右边，</p><script type="math/tex; mode=display">\sum_{i=0}^n(-1)^{n-i}\binom{n}{i}g_i=\sum_{i=0}^n(-1)^{n-i}\binom{n}{i}\sum_{j=0}^i\binom{n}{j}f_j</script><p>考虑交换枚举顺序（交换之前可以认为是在逐行枚举杨辉三角，交换之后可以视作按列枚举杨辉三角），</p><script type="math/tex; mode=display">\sum_{j=0}^n\sum_{i=j}^n(-1)^{n-i}\binom{n}{i}\binom{i}{j}f_j</script><p>将中间的组合数拆开来算，</p><script type="math/tex; mode=display">\binom{n}{i}\binom{i}{j}=\frac{n!}{i!(n-i)!}\cdot\frac{i!}{j!(i-j)!}=\frac{n!}{j!(n-j)!}\cdot\frac{(n-j)!}{(n-i)!(i-j)!}=\binom{n}{j}\binom{n-j}{n-i}</script><p>原式等于</p><script type="math/tex; mode=display">\sum_{j=0}^n\sum_{i=j}^n(-1)^{n-i}\binom{n}{j}\binom{n-j}{n-i}f_j</script><p>将和 $i$ 无关的提到前面，</p><script type="math/tex; mode=display">\sum_{j=0}^n\binom{n}{j}f_j\sum_{i=j}^n(-1)^{n-i}\binom{n-j}{n-i}</script><p>第二个求和符号改为枚举 $k$，使得 $i=n-k$，</p><script type="math/tex; mode=display">\sum_{j=0}^m\binom{n}{j}f_j\sum_{k=0}^{n-j}(-1)^{k}\binom{n-j}{n-k}</script><p>然后可以分情况讨论，</p><ul><li>如果 $j\not= n$，后面的和式可以使用二项式定理求出和为 $0$。</li><li>如果 $j=n$，和式为 $\binom{n}{n}f_n\cdot 1$。</li></ul><p>所以等式得证。</p><h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><p>看几个例子吧。</p><h4 id="错排问题"><a href="#错排问题" class="headerlink" title="错排问题"></a>错排问题</h4><p>起初 $n$ 个物品一一对应地放进 $n$ 个盒子里，然后打乱顺序，问任意物品都不在原来位置的方案数。</p><p>设 $f_i$ 表示有 $i$ 个物品不在原来位置的方案数， $g_i$ 表示所有的方案数。很容易得到下式</p><script type="math/tex; mode=display">g_i=\sum_{i=0}^n\binom{n}{i}f_i</script><p>根据二项式反演可以得到</p><script type="math/tex; mode=display">f_n=\sum_{i=0}^n(-1)^{n-i}\binom{n}{i}g_i</script><p>注意到 $g_n=n!$，所以</p><script type="math/tex; mode=display">f_n=\sum_{i=0}^n(-1)^{n-i}\frac{n!}{i!(n-i)!}\cdot i!</script><p>略微整理一下</p><script type="math/tex; mode=display">f_n=n!\sum_{i=0}^n\frac{(-1)^{n-i}}{(n-i)!}</script><p>改变一下 $i$ 的含义（令 $i=n-i$），</p><script type="math/tex; mode=display">f_n=n!\sum_{i=0}^n\frac{(-1)^i}{i!}</script><p>然后我们就得到了错排的通项公式！</p><h2 id="莫比乌斯反演"><a href="#莫比乌斯反演" class="headerlink" title="莫比乌斯反演"></a>莫比乌斯反演</h2><h3 id="狄利克雷卷积"><a href="#狄利克雷卷积" class="headerlink" title="狄利克雷卷积"></a>狄利克雷卷积</h3><p>定义两个数论函数的的卷积 $(f*g)(n):=\sum_{e|n}f(e)g(\frac{n}{e})$。<br>迪利克雷卷积的单位元为 $\varepsilon(n)=[n==1]$。</p><p>卷积运算主要有以下推论：</p><ul><li>$\mu * I = \varepsilon$</li><li>$\varphi * I = Id$</li><li>$\sigma * \mu=I * I * \mu = I * \varepsilon=I$，其中 $\sigma$ 表示约数个数函数。</li></ul><h3 id="反演形式"><a href="#反演形式" class="headerlink" title="反演形式"></a>反演形式</h3><p>若 $g(n)=\sum_{e|b}f(e)$，即 $g=f*I$，根据卷积的推论可以得到</p><script type="math/tex; mode=display">f*I*\mu=g*\mu\Rightarrow f=g*\mu</script><p>若 $g$ 有简洁的通项公式，加之 $\mu$ 可以使用线性筛或者杜教筛等方法，可以在 $O(n)$ 甚至 $O(n^{\frac{2}{3}})$ 的时间内求解 $f(n)$。</p><script>var a=document.getElementsByTagName("h1");for(var i=0;i<a.length;++i)if(a[i].parentNode.className.indexOf("markdown-body")>-1)document.getElementById("subtitle").title=a[i].innerHTML,a[i].parentNode.removeChild(a[i]);</script>]]></content>
    
    
    <categories>
      
      <category>数学</category>
      
      <category>数论</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数学</tag>
      
      <tag>反演</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>开端</title>
    <link href="/2022/02/27/%E5%BC%80%E7%AB%AF/"/>
    <url>/2022/02/27/%E5%BC%80%E7%AB%AF/</url>
    
    <content type="html"><![CDATA[<p>2022-02-27：__Xu128’s Blog 搭建完成！</p>]]></content>
    
    
    <categories>
      
      <category>开端</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
